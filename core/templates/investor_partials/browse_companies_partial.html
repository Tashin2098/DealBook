

{% block content %}
{% load startup_extras %}

<style>
/* Modern UI Styles - Scoped to browse-companies content only */
.browse-companies-container {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background-color: #f8fafc;
    color: #1e293b;
    max-width: 1400px;
    margin: 0 auto;
    padding: 32px 24px;
}

.browse-companies-container h1 {
    font-size: 2rem;
    font-weight: 700;
    color: #0f172a;
    margin: 0 0 32px 0;
}

.browse-companies-container .search-section {
    margin: 18px 0 30px 0;
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
}

.browse-companies-container .search-input {
    width: 400px;
    font-size: 1rem;
    padding: 12px 16px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    background: white;
    transition: all 0.2s ease;
    font-family: inherit;
}

.browse-companies-container .search-input:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.browse-companies-container .search-input::placeholder {
    color: #94a3b8;
}

.browse-companies-container .modern-btn {
    padding: 12px 20px;
    font-size: 0.95rem;
    font-weight: 500;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-family: inherit;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.browse-companies-container .btn-primary {
    background: #3b82f6;
    color: white;
}

.browse-companies-container .btn-primary:hover {
    background: #2563eb;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

.browse-companies-container .btn-secondary {
    background: #ef4444;
    color: white;
}

.browse-companies-container .btn-secondary:hover {
    background: #dc2626;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}

.browse-companies-container .modern-table-container {
    background: white;
    border-radius: 12px;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    border: 1px solid #f1f5f9;
}

.browse-companies-container table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    background: transparent;
}

.browse-companies-container thead {
    background: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
}

.browse-companies-container th {
    padding: 16px 20px;
    text-align: left;
    font-weight: 600;
    font-size: 0.85rem;
    color: #475569;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border: none;
    vertical-align: middle;
}

.browse-companies-container tbody tr {
    border-bottom: 1px solid #f1f5f9;
    transition: background-color 0.2s ease;
}

.browse-companies-container tbody tr:hover {
    background-color: #f8fafc;
}

.browse-companies-container tbody tr:last-child {
    border-bottom: none;
}

.browse-companies-container td {
    padding: 16px 20px;
    vertical-align: middle;
    border: none;
}

.browse-companies-container .company-name {
    font-weight: 600;
    color: #0f172a;
    font-size: 0.95rem;
}

.browse-companies-container .contact-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.browse-companies-container .contact-name {
    font-weight: 500;
    color: #0f172a;
    font-size: 0.9rem;
}

.browse-companies-container .contact-email {
    font-size: 0.8rem;
    color: #64748b;
}

.browse-companies-container .action-btn {
    padding: 8px 16px;
    font-size: 0.85rem;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 70px;
}

.browse-companies-container .btn-view {
    background: #f1f5f9;
    color: #475569;
}

.browse-companies-container .btn-view:hover {
    background: #e2e8f0;
    color: #334155;
    transform: translateY(-1px);
}

.browse-companies-container .btn-invest {
    background: #dcfce7;
    color: #166534;
}

.browse-companies-container .btn-invest:hover {
    background: #bbf7d0;
    color: #15803d;
    transform: translateY(-1px);
}

/* Modern Save Button Styles */
.browse-companies-container .save-action {
    display: flex;
    align-items: center;
    justify-content: center;
}

.browse-companies-container .save-btn {
    padding: 8px 16px;
    font-size: 0.85rem;
    border-radius: 6px;
    border: 1px solid #e2e8f0;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    min-width: 80px;
    background: white;
    color: #475569;
}

.browse-companies-container .save-btn:hover {
    border-color: #3b82f6;
    color: #3b82f6;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
}

.browse-companies-container .save-btn.saved {
    background: #dcfce7;
    border-color: #22c55e;
    color: #166534;
    cursor: default;
}

.browse-companies-container .save-btn.saved:hover {
    transform: none;
    box-shadow: none;
}

.browse-companies-container .save-icon {
    font-size: 0.9rem;
    transition: transform 0.2s ease;
}

.browse-companies-container .save-btn:hover .save-icon:not(.saved-icon) {
    transform: scale(1.1);
}

.browse-companies-container .invested-status {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    color: #166534;
    font-weight: 500;
    font-size: 0.85rem;
    background: #dcfce7;
    padding: 8px 16px;
    border-radius: 6px;
    border: 1px solid #22c55e;
}

.browse-companies-container .no-results-modern {
    text-align: center;
    padding: 60px 20px;
    color: #64748b;
    font-size: 1rem;
}

.browse-companies-container .no-results-icon {
    font-size: 3rem;
    margin-bottom: 16px;
    color: #cbd5e1;
}

/* Center alignment for action columns */
.browse-companies-container th:nth-child(3),
.browse-companies-container th:nth-child(4),
.browse-companies-container th:nth-child(5) {
    text-align: center;
}

.browse-companies-container td:nth-child(3),
.browse-companies-container td:nth-child(4),
.browse-companies-container td:nth-child(5) {
    text-align: center;
}

/* Status badges */
.browse-companies-container .status-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
}

.browse-companies-container .badge-success {
    background: #dcfce7;
    color: #166534;
}

.browse-companies-container .badge-info {
    background: #e0e7ff;
    color: #3730a3;
}

/* Hide rows functionality */
.browse-companies-container .company-row.hidden {
    display: none !important;
}

/* Enhanced Modal Styles - Same as second code */
.modal-details-section { 
    background: #f8fafc; 
    border-radius: 8px; 
    padding: 20px; 
    margin-bottom: 24px; 
    border-left: 4px solid #3b82f6; 
}

.modal-section-title { 
    font-size: 18px; 
    font-weight: 600; 
    color: #1e293b; 
    margin-bottom: 16px; 
    display: flex; 
    align-items: center; 
    gap: 8px; 
}

.modal-section-content { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
    gap: 16px; 
}

.modal-field-group { 
    background: white; 
    padding: 16px; 
    border-radius: 6px; 
    box-shadow: 0 1px 3px rgba(0,0,0,.1); 
    transition: transform .2s, box-shadow .2s; 
}

.modal-field-group:hover { 
    transform: translateY(-1px); 
    box-shadow: 0 4px 12px rgba(0,0,0,.15); 
}

.modal-field-label { 
    font-weight: 600; 
    color: #475569; 
    font-size: 13px; 
    text-transform: uppercase; 
    letter-spacing: .5px; 
    margin-bottom: 6px; 
    display: block; 
}

.modal-field-value { 
    color: #0f172a; 
    font-size: 14px; 
    word-wrap: break-word; 
    line-height: 1.5; 
}

.modal-field-value a { 
    color: #3b82f6; 
    text-decoration: none; 
    font-weight: 500; 
    transition: color .2s; 
}

.modal-field-value a:hover { 
    color: #1d4ed8; 
    text-decoration: underline; 
}

.modal-badge { 
    display: inline-block; 
    padding: 4px 12px; 
    background: #e0e7ff; 
    color: #3730a3; 
    border-radius: 20px; 
    font-size: 12px; 
    font-weight: 500; 
}

.modal-icon { 
    width: 20px; 
    height: 20px; 
    fill: currentColor; 
}

/* Responsive Design */
@media (max-width: 1024px) {
    .browse-companies-container {
        padding: 24px 16px;
    }
    
    .browse-companies-container .search-input {
        width: 300px;
    }
}

@media (max-width: 768px) {
    .browse-companies-container h1 {
        font-size: 1.75rem;
        margin-bottom: 24px;
    }
    
    .browse-companies-container .search-section {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
    }
    
    .browse-companies-container .search-input {
        width: 100%;
    }
    
    .browse-companies-container .modern-btn {
        width: 100%;
        justify-content: center;
    }
    
    .browse-companies-container th,
    .browse-companies-container td {
        padding: 12px 16px;
    }
    
    .browse-companies-container th {
        font-size: 0.8rem;
    }
    
    .browse-companies-container .modern-table-container {
        overflow-x: auto;
    }
    
    .browse-companies-container table {
        min-width: 600px;
    }
    
    .modal-section-content { 
        grid-template-columns: 1fr; 
    }
}

@media (max-width: 480px) {
    .browse-companies-container {
        padding: 20px 12px;
    }
    
    .browse-companies-container h1 {
        font-size: 1.5rem;
    }
    
    .browse-companies-container .contact-info {
        gap: 2px;
    }
    
    .browse-companies-container .contact-name {
        font-size: 0.85rem;
    }
    
    .browse-companies-container .contact-email {
        font-size: 0.75rem;
    }
    
    .browse-companies-container .action-btn,
    .browse-companies-container .save-btn {
        padding: 6px 12px;
        font-size: 0.8rem;
        min-width: 60px;
    }
}

/* Loading states and animations */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.browse-companies-container .modern-table-container {
    animation: fadeIn 0.3s ease-out;
}

/* Focus styles for accessibility */
.browse-companies-container .action-btn:focus,
.browse-companies-container .save-btn:focus,
.browse-companies-container .modern-btn:focus {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}

/* Print styles */
@media print {
    .browse-companies-container .search-section {
        display: none;
    }
    
    .browse-companies-container .action-btn {
        display: none;
    }
    
    .browse-companies-container .save-action {
        display: none;
    }
}
</style>

<div class="browse-companies-container">
    <h1>Browse Companies</h1>

    <div class="search-section">
        <input type="text" 
               id="searchInput" 
               placeholder="Search company/name/email" 
               class="search-input">
        <button id="searchButton" onclick="performSearch()" class="modern-btn btn-primary">
            Search
        </button>
        <button id="clearButton" onclick="clearSearch()" class="modern-btn btn-secondary" style="display:none;">
            Clear
        </button>
    </div>

    <div class="modern-table-container">
        <table>
            <thead>
                <tr>
                    <th>Company</th>
                    <th>Contact</th>
                    <th>Save</th>
                    <th>Details</th>
                    <th>Investment</th>
                </tr>
            </thead>
            <tbody id="companiesTableBody">
                {% for startup in startups %}
                <tr class="company-row" 
                    data-company="{{ startup.startup_name|lower }}" 
                    data-name="{{ startup.user.get_full_name|lower }}" 
                    data-email="{{ startup.email|lower }}">
                    <td>
                        <div class="company-name">{{ startup.startup_name }}</div>
                    </td>
                    <td>
                        <div class="contact-info">
                            <div class="contact-name">{{ startup.user.get_full_name }}</div>
                            <div class="contact-email">{{ startup.email }}</div>
                        </div>
                    </td>
                    <td>
                        <div class="save-action">
                            {% if startup.id in saved %}
                                <span class="save-btn saved" title="Saved">
                                    <span class="save-icon saved-icon">✓</span>
                                    Saved
                                </span>
                            {% else %}
                                <a href="{% url 'save_company' startup.id %}" 
                                   class="save-btn" 
                                   title="Save Company"
                                   aria-label="Save {{ startup.startup_name }}">
                                    <span class="save-icon">+</span>
                                    Save
                                </a>
                            {% endif %}
                        </div>
                    </td>
                    <td>
                        <button type="button" 
    class="action-btn btn-view view-details-btn"
    title="View Details"
    aria-label="View details for {{ startup.startup_name }}"
    data-startup-id="{{ startup.id }}"
    data-startup-name="{{ startup.startup_name }}"
    data-user-first-name="{{ startup.user.first_name|default:'' }}"
    data-user-email="{{ startup.user.email|default:'' }}"
    data-role="{{ startup.role|default:'N/A' }}"
    data-email="{{ startup.email|default:'N/A' }}"
    data-heard-about="{{ startup.heard_about|default:'N/A' }}"
    data-description="{{ startup.description|default:'N/A' }}"
    data-audience="{{ startup.audience|default:'N/A' }}"
    data-tech-component="{{ startup.tech_component|default:'N/A' }}"
    data-your-edge="{{ startup.your_edge|default:'N/A' }}"
    data-pitch-deck-url="{{ startup.pitch_deck_url|default:'' }}"
    data-startup-stage="{{ startup.startup_stage|default:'N/A' }}"
    data-problem="{{ startup.problem|default:'N/A' }}"
    data-solution="{{ startup.solution|default:'N/A' }}"
    data-market-research="{{ startup.market_research|default:'N/A' }}"
    data-business-model-mind="{{ startup.business_model_mind|default:'N/A' }}"
    data-working-time="{{ startup.working_time|default:'N/A' }}"
    data-cofounder="{{ startup.cofounder|default:'N/A' }}"
    data-support-needed="{{ startup.support_needed|default:'N/A' }}"
    data-has-mvp="{{ startup.has_mvp|default:'N/A' }}"
    data-tested-with-customers="{{ startup.tested_with_customers|default:'N/A' }}"
    data-funding-source="{{ startup.funding_source|default:'N/A' }}"
    data-early-users="{{ startup.early_users|default:'N/A' }}"
    data-generated-revenue="{{ startup.generated_revenue|default:'N/A' }}"
    data-stage3-challenges="{{ startup.stage3_challenges|default:'N/A' }}"
    data-stage3-support="{{ startup.stage3_support|default:'N/A' }}"
    data-business-model="{{ startup.business_model|default:'N/A' }}"
    data-paying-customers="{{ startup.paying_customers|default:'N/A' }}"
    data-annual-revenue-4="{{ startup.annual_revenue_4|default:'N/A' }}"
    data-external-funding="{{ startup.external_funding|default:'N/A' }}"
    data-acquisition-strategies="{{ startup.acquisition_strategies|default:'N/A' }}"
    data-team-size="{{ startup.team_size|default:'N/A' }}"
    data-stage4-challenges="{{ startup.stage4_challenges|default:'N/A' }}"
    data-stage4-support="{{ startup.stage4_support|default:'N/A' }}"
    data-annual-revenue-5="{{ startup.annual_revenue_5|default:'N/A' }}"
    data-active-customers-5="{{ startup.active_customers_5|default:'N/A' }}"
    data-markets-operating="{{ startup.markets_operating|default:'N/A' }}"
    data-expansion-plans="{{ startup.expansion_plans|default:'N/A' }}"
    data-stage5-challenges="{{ startup.stage5_challenges|default:'N/A' }}">
    View
</button>

                    </td>
                    <td>
                        {% if startup.id in invested %}
                            <span class="invested-status">
                                <span>✓</span>
                                Invested
                            </span>
                        {% else %}
                            <a href="{% url 'invest_in_company' startup.id %}" 
                               class="action-btn btn-invest"
                               title="Invest in Company"
                               aria-label="Invest in {{ startup.startup_name }}">
                                Invest
                            </a>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">
                        <div class="no-results-modern">
                            <div class="no-results-icon">🔍</div>
                            No companies found.
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="noResultsMessage" class="no-results-modern" style="display:none;">
        <div class="no-results-icon">🔍</div>
        <span id="noResultsText">No companies found matching your search criteria.</span>
    </div>

    {% if startups.count > 10 %}
    <div style="margin-top: 24px; text-align: center; color: #64748b; font-size: 0.9rem;">
        Showing {{ startups.count }} companies
    </div>
    {% endif %}
</div>

<!-- Enhanced Modal - Same structure as second code -->
<div id="companyModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0, 0, 0, 0.5); z-index:1000; overflow-y:auto; padding:20px; box-sizing:border-box;">
    <div id="companyModalBox" style="max-width:900px; width:100%; margin:40px auto; background:white; border-radius:12px; box-shadow:0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04); position:relative; min-height:fit-content;">
        <div style="padding:24px 32px; border-bottom:1px solid #e2e8f0; display:flex; justify-content:space-between; align-items:center;">
            <h2 style="font-weight:700; margin:0; font-size:1.5rem; color:#0f172a;">Company Details</h2>
            <button type="button" onclick="closeCompanyModal()"
                    style="width:32px; height:32px; border:none; background:#f1f5f9; border-radius:50%; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:18px; color:#64748b; transition:all .2s;"
                    onmouseover="this.style.background='#e2e8f0'"
                    onmouseout="this.style.background='#f1f5f9'">&times;</button>
        </div>
        <div id="companyModalContent" style="padding:24px 32px 32px; max-height:calc(90vh - 120px); overflow-y:auto;"></div>
    </div>
</div>

<script>
// Search functionality - matching the logic from the second code
function performSearch() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
    const rows = document.querySelectorAll('.company-row');
    const table = document.querySelector('.modern-table-container');
    const noResultsMessage = document.getElementById('noResultsMessage');
    const noResultsText = document.getElementById('noResultsText');
    const clearButton = document.getElementById('clearButton');
    
    if (searchTerm === '') {
        rows.forEach(row => row.classList.remove('hidden'));
        table.style.display = 'block';
        noResultsMessage.style.display = 'none';
        clearButton.style.display = 'none';
        return;
    }
    
    let visibleCount = 0;
    
    rows.forEach(row => {
        const company = row.dataset.company || '';
        const name = row.dataset.name || '';
        const email = row.dataset.email || '';
        
        const matches = company.includes(searchTerm) || 
                       name.includes(searchTerm) || 
                       email.includes(searchTerm);
        
        if (matches) {
            row.classList.remove('hidden');
            visibleCount++;
        } else {
            row.classList.add('hidden');
        }
    });
    
    if (visibleCount === 0) {
        table.style.display = 'none';
        noResultsMessage.style.display = 'block';
        noResultsText.textContent = `No companies found matching "${searchTerm}".`;
    } else {
        table.style.display = 'block';
        noResultsMessage.style.display = 'none';
    }
    
    clearButton.style.display = 'inline-block';
}

// Clear search functionality
function clearSearch() {
    document.getElementById('searchInput').value = '';
    const rows = document.querySelectorAll('.company-row');
    const table = document.querySelector('.modern-table-container');
    const noResultsMessage = document.getElementById('noResultsMessage');
    const clearButton = document.getElementById('clearButton');
    
    rows.forEach(row => row.classList.remove('hidden'));
    table.style.display = 'block';
    noResultsMessage.style.display = 'none';
    clearButton.style.display = 'none';
}

// Close modal function
function closeCompanyModal() {
    document.getElementById('companyModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

// Event delegation for view details buttons
document.addEventListener('click', function(e) {
    const btn = e.target.closest('.view-details-btn');
    if (!btn) return;

    const data = {
    id: btn.dataset.startupId,
    startup_name: btn.dataset.startupName,
    user_first_name: btn.dataset.userFirstName,
    user_email: btn.dataset.userEmail,
    role: btn.dataset.role,
    email: btn.dataset.email,
    heard_about: btn.dataset.heardAbout,
    description: btn.dataset.description,
    audience: btn.dataset.audience,
    tech_component: btn.dataset.techComponent,
    your_edge: btn.dataset.yourEdge,
    pitch_deck_url: btn.dataset.pitchDeckUrl,
    startup_stage: btn.dataset.startupStage,
    problem: btn.dataset.problem,
    solution: btn.dataset.solution,
    market_research: btn.dataset.marketResearch,
    business_model_mind: btn.dataset.businessModelMind,
    working_time: btn.dataset.workingTime,
    cofounder: btn.dataset.cofounder,
    support_needed: btn.dataset.supportNeeded,
    has_mvp: btn.dataset.hasMvp,
    tested_with_customers: btn.dataset.testedWithCustomers,
    funding_source: btn.dataset.fundingSource,
    early_users: btn.dataset.earlyUsers,
    generated_revenue: btn.dataset.generatedRevenue,
    stage3_challenges: btn.dataset.stage3Challenges,
    stage3_support: btn.dataset.stage3Support,
    business_model: btn.dataset.businessModel,
    paying_customers: btn.dataset.payingCustomers,
    annual_revenue_4: btn.dataset.annualRevenue4,
    external_funding: btn.dataset.externalFunding,
    acquisition_strategies: btn.dataset.acquisitionStrategies,
    team_size: btn.dataset.teamSize,
    stage4_challenges: btn.dataset.stage4Challenges,
    stage4_support: btn.dataset.stage4Support,
    annual_revenue_5: btn.dataset.annualRevenue5,
    active_customers_5: btn.dataset.activeCustomers5,
    markets_operating: btn.dataset.marketsOperating,
    expansion_plans: btn.dataset.expansionPlans,
    stage5_challenges: btn.dataset.stage5Challenges
};


    
    renderCompanyModal(data);
});

function renderCompanyModal(data) {
    let html = `
            <!-- Basic Information Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    Basic Information
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Startup Name</label>
                        <div class="modal-field-value">${data.startup_name || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Founder Name</label>
                        <div class="modal-field-value">${data.user_first_name || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Role</label>
                        <div class="modal-field-value">${data.role ? `<span class="modal-badge">${data.role}</span>` : 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Email</label>
                        <div class="modal-field-value">${data.email || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">How heard about us</label>
                        <div class="modal-field-value">${data.heard_about || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Pitch Deck</label>
                        <div class="modal-field-value">${data.pitch_deck_url ? `<a href="${data.pitch_deck_url}" target="_blank">View Pitch Deck</a>` : 'N/A'}</div>
                    </div>
                </div>
            </div>

            <!-- Business Overview Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/>
                    </svg>
                    Business Overview
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Description</label>
                        <div class="modal-field-value">${data.description || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Target Audience</label>
                        <div class="modal-field-value">${data.audience || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Tech Component</label>
                        <div class="modal-field-value">${data.tech_component || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Your Edge</label>
                        <div class="modal-field-value">${data.your_edge || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Startup Stage</label>
                        <div class="modal-field-value">${data.startup_stage ? `<span class="modal-badge">${data.startup_stage}</span>` : 'N/A'}</div>
                    </div>
                </div>
            </div>

            <!-- Problem & Solution Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                    </svg>
                    Problem & Solution
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Problem</label>
                        <div class="modal-field-value">${data.problem || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Solution</label>
                        <div class="modal-field-value">${data.solution || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Market Research</label>
                        <div class="modal-field-value">${data.market_research || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Business Model</label>
                        <div class="modal-field-value">${data.business_model_mind || 'N/A'}</div>
                    </div>
                </div>
            </div>

            <!-- Current Status Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
                    </svg>
                    Current Status
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Working Time</label>
                        <div class="modal-field-value">${data.working_time ? `<span class="modal-badge">${data.working_time}</span>` : 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Co-founder</label>
                        <div class="modal-field-value">${data.cofounder || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">MVP Status</label>
                        <div class="modal-field-value">${data.has_mvp || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Customer Testing</label>
                        <div class="modal-field-value">${data.tested_with_customers || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Early Users</label>
                        <div class="modal-field-value">${data.early_users || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Revenue Status</label>
                        <div class="modal-field-value">${data.generated_revenue || 'N/A'}</div>
                    </div>
                </div>
            </div>

            <!-- Business Development Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"/>
                    </svg>
                    Business Development
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Business Model</label>
                        <div class="modal-field-value">${data.business_model || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Paying Customers</label>
                        <div class="modal-field-value">${data.paying_customers || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Annual Revenue</label>
                        <div class="modal-field-value">${data.annual_revenue_4 || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">External Funding</label>
                        <div class="modal-field-value">${data.external_funding || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Acquisition Strategies</label>
                        <div class="modal-field-value">${data.acquisition_strategies || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Team Size</label>
                        <div class="modal-field-value">${data.team_size || 'N/A'}</div>
                    </div>
                </div>
            </div>

            <!-- Growth & Expansion Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                    </svg>
                    Growth & Expansion
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Annual Revenue (Advanced)</label>
                        <div class="modal-field-value">${data.annual_revenue_5 || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Active Customers</label>
                        <div class="modal-field-value">${data.active_customers_5 || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Markets Operating</label>
                        <div class="modal-field-value">${data.markets_operating || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Expansion Plans</label>
                        <div class="modal-field-value">${data.expansion_plans || 'N/A'}</div>
                    </div>
                </div>
            </div>

            <!-- Support & Challenges Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2Z"/>
                    </svg>
                    Support & Challenges
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Support Needed</label>
                        <div class="modal-field-value">${data.support_needed || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Stage 3 Challenges</label>
                        <div class="modal-field-value">${data.stage3_challenges || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Stage 3 Support</label>
                        <div class="modal-field-value">${data.stage3_support || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Stage 4 Challenges</label>
                        <div class="modal-field-value">${data.stage4_challenges || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Stage 4 Support</label>
                        <div class="modal-field-value">${data.stage4_support || 'N/A'}</div>
                    </div>
                    <div class="modal-field-group">
                        <label class="modal-field-label">Stage 5 Challenges</label>
                        <div class="modal-field-value">${data.stage5_challenges || 'N/A'}</div>
                    </div>
                </div>
            </div>

            <!-- Funding Section -->
            <div class="modal-details-section">
                <h3 class="modal-section-title">
                    <svg class="modal-icon" viewBox="0 0 24 24">
                        <path d="M5,6H23V18H5V6M14,9A3,3 0 0,1 17,12A3,3 0 0,1 14,15A3,3 0 0,1 11,12A3,3 0 0,1 14,9M9,8A2,2 0 0,1 7,10V14A2,2 0 0,1 9,16H19A2,2 0 0,1 21,14V10A2,2 0 0,1 19,8H9Z"/>
                    </svg>
                    Funding Information
                </h3>
                <div class="modal-section-content">
                    <div class="modal-field-group">
                        <label class="modal-field-label">Funding Source</label>
                        <div class="modal-field-value">${data.funding_source || 'N/A'}</div>
                    </div>
                </div>
            </div>
        `;
    
        document.getElementById('companyModalContent').innerHTML = html;
    document.getElementById('companyModal').style.display = 'block';
    document.body.style.overflow = 'hidden'; // prevent background scroll
}
</script>
{% endblock %}